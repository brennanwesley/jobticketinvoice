"use strict";(self.webpackChunkjobticketinvoice_frontend=self.webpackChunkjobticketinvoice_frontend||[]).push([[782],{4111:(e,r,t)=>{t.d(r,{_P:()=>s});const a=e=>{if(!e)return!1;return/^([01]?[0-9]|2[0-3]):([0-5][0-9])$/.test(e)},s=(e,r)=>{if(!a(e)||!a(r))return null;const[t,s]=e.split(":").map(Number),[i,l]=r.split(":").map(Number);let o=i-t,d=l-s;return d<0&&(o--,d+=60),o<0&&(o+=24),parseFloat((o+d/60).toFixed(2))}},6782:(e,r,t)=>{t.r(r),t.d(r,{default:()=>b});var a=t(2555),s=t(5043),i=t(4858),l=t(2136),o=t(3059),d=t(4111),n=t(3104),c=t(2376),m=t(579);const u=e=>{var r,t;let{readOnly:u=!1,draftData:b=null}=e;const{t:p}=(0,l.ok)(),{formData:x,updateFormData:j,saveJobTicketAsDraft:g}=(0,o.yS)(),[y,T]=(0,s.useState)(""),{register:k,handleSubmit:h,control:v,setValue:f,watch:N,formState:{errors:w}}=(0,i.mN)({defaultValues:b||x,mode:"onChange"}),S=N("workStartTime"),D=N("workEndTime"),E=N("driveStartTime"),O=N("driveEndTime"),C=(0,c.d7)(S,300),P=(0,c.d7)(D,300),q=(0,c.d7)(E,300),F=(0,c.d7)(O,300);(0,s.useEffect)((()=>{if(C&&P){const e=(0,d._P)(C,P);null!==e&&f("workTotalHours",e)}}),[C,P,f]),(0,s.useEffect)((()=>{if(q&&F){const e=(0,d._P)(q,F);null!==e&&f("driveTotalHours",e)}}),[q,F,f]),(0,s.useEffect)((()=>{const e=N(((e,r)=>{let{name:t,type:a}=r;"change"===a&&t&&j(t,e[t])}));return()=>e.unsubscribe()}),[N,j]);const H=(0,s.useMemo)((()=>[{value:p("partLubricant"),label:p("partLubricant")},{value:p("partPumpSeal"),label:p("partPumpSeal")},{value:p("partThrustChamber"),label:p("partThrustChamber")},{value:p("partVFDBreaker"),label:p("partVFDBreaker")},{value:p("partServiceKit"),label:p("partServiceKit")},{value:p("partOther"),label:p("partOther")}]),[p]),V=(0,s.useCallback)((()=>{if(!y)return;const e=N("parts")||[];f("parts",[...e,y]),T("")}),[y,N,f]),_=(0,s.useCallback)((e=>{const r=[...N("parts")||[]];r.splice(e,1),f("parts",r)}),[N,f]),{submitJobTicket:$,isSubmitting:A,submitError:B,submitSuccess:J}=(0,o.yS)(),[K,L]=(0,s.useState)(!1),[W,z]=(0,s.useState)(!1);(0,s.useEffect)((()=>{if(J){L(!0);const e=setTimeout((()=>L(!1)),5e3);return()=>clearTimeout(e)}}),[J]),(0,s.useEffect)((()=>{if(B){z(!0);const e=setTimeout((()=>z(!1)),5e3);return()=>clearTimeout(e)}}),[B]);const M=(0,c.DW)((async e=>{try{const r=g(e);await $(r)}catch(r){console.error("Error submitting job ticket:",r)}}));return(0,m.jsx)(n.lV,{onSubmit:h(M),className:"space-y-6 max-w-3xl mx-auto",children:(0,m.jsxs)(n.Zp,{className:"p-6",children:[K&&(0,m.jsx)("div",{className:"mb-4 p-4 bg-green-900 bg-opacity-20 border border-green-700 rounded-md",children:(0,m.jsx)("p",{className:"text-green-400",children:p("jobTicket.submitSuccess")})}),W&&(0,m.jsx)("div",{className:"mb-4 p-4 bg-red-900 bg-opacity-20 border border-red-700 rounded-md",children:(0,m.jsx)("p",{className:"text-red-400",children:B})}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,m.jsx)(n.pd,{type:"date",id:"jobDate",name:"jobDate",label:p("jobTicket.date"),register:k,rules:{required:!0},error:w.jobDate,errorText:p("errors.required"),readOnly:u}),(0,m.jsx)(n.pd,{type:"text",id:"companyName",name:"companyName",label:p("jobTicket.companyName"),register:k,rules:{required:!0},error:w.companyName,errorText:p("errors.required"),readOnly:u}),(0,m.jsx)(n.pd,{type:"text",id:"customerName",name:"customerName",label:p("jobTicket.customerName"),register:k,readOnly:u}),(0,m.jsx)(n.pd,{type:"text",id:"location",name:"location",label:p("jobTicket.location"),register:k,readOnly:u}),(0,m.jsx)(n.pd,{type:"text",id:"workType",name:"workType",label:p("jobTicket.workType")||"Work Type",register:k,readOnly:u}),(0,m.jsx)(n.pd,{type:"text",id:"equipment",name:"equipment",label:p("jobTicket.equipment")||"Equipment Serviced",register:k,readOnly:u})]}),(0,m.jsxs)("div",{className:"mt-8",children:[(0,m.jsx)("h3",{className:"text-lg font-medium text-gray-200 mb-4",children:p("jobTicket.workTotalTime")}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,m.jsx)(n.pd,{type:"time",id:"workStartTime",name:"workStartTime",label:p("jobTicket.workStartTime"),register:k,readOnly:u}),(0,m.jsx)(n.pd,{type:"time",id:"workEndTime",name:"workEndTime",label:p("jobTicket.workEndTime"),register:k,readOnly:u}),(0,m.jsx)(n.pd,{type:"number",id:"workTotalHours",name:"workTotalHours",label:p("jobTicket.workTotalTime"),register:k,readOnly:!0,step:"0.01"})]})]}),(0,m.jsxs)("div",{className:"mt-8",children:[(0,m.jsx)("h3",{className:"text-lg font-medium text-gray-200 mb-4",children:p("jobTicket.travelTotalTime")}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,m.jsx)(n.pd,{type:"time",id:"driveStartTime",name:"driveStartTime",label:p("jobTicket.travelStartTime"),register:k,readOnly:u}),(0,m.jsx)(n.pd,{type:"time",id:"driveEndTime",name:"driveEndTime",label:p("jobTicket.travelEndTime"),register:k,readOnly:u}),(0,m.jsx)(n.pd,{type:"number",id:"driveTotalHours",name:"driveTotalHours",label:p("jobTicket.travelTotalTime"),register:k,readOnly:!0,step:"0.01"})]})]}),(0,m.jsxs)("div",{className:"mt-8",children:[(0,m.jsx)("h3",{className:"text-lg font-medium text-gray-200 mb-4",children:p("jobTicket.parts.title")}),!u&&(0,m.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,m.jsxs)("select",{className:"bg-gray-800 block w-full rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",value:y,onChange:e=>T(e.target.value),children:[(0,m.jsx)("option",{value:"",children:p("selectPartsPlaceholder")}),H.map((e=>(0,m.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,m.jsx)(n.$n,{type:"button",onClick:V,disabled:!y,variant:"secondary",children:p("addPart")})]}),(0,m.jsx)("div",{className:"bg-gray-800 rounded-md border border-gray-700 p-4",children:(null===(r=N("parts"))||void 0===r?void 0:r.length)>0?(0,m.jsx)("ul",{className:"divide-y divide-gray-700",children:null===(t=N("parts"))||void 0===t?void 0:t.map(((e,r)=>(0,m.jsxs)("li",{className:"py-2 flex justify-between items-center",children:[(0,m.jsx)("span",{children:e}),!u&&(0,m.jsx)(n.$n,{type:"button",onClick:()=>_(r),variant:"danger",size:"sm",children:p("removePart")})]},r)))}):(0,m.jsx)("p",{className:"text-gray-400",children:p("noParts","No parts added")})})]}),(0,m.jsxs)("div",{className:"mt-8",children:[(0,m.jsx)("label",{htmlFor:"workDescription",className:"block text-sm font-medium text-gray-300",children:p("jobTicket.workDescription")}),(0,m.jsx)("div",{className:"mt-1",children:(0,m.jsx)("textarea",(0,a.A)((0,a.A)({id:"workDescription",name:"workDescription",className:"bg-gray-800 block w-full rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",rows:4,placeholder:p("jobTicket.workDescription")},k("workDescription")),{},{readOnly:u}))})]}),!u&&(0,m.jsx)("div",{className:"mt-8 flex justify-end",children:(0,m.jsx)(n.$n,{type:"submit",disabled:A,className:"w-full md:w-auto",children:p(A?"submitting":"submit")})})]})})},b=s.memo(u)}}]);
//# sourceMappingURL=782.033fb12c.chunk.js.map