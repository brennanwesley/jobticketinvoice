"use strict";(self.webpackChunkjobticketinvoice_frontend=self.webpackChunkjobticketinvoice_frontend||[]).push([[957],{2455:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(3986),a=r(5043);const o=["title","titleId"];const n=a.forwardRef((function(e,t){let{title:r,titleId:n}=e,i=(0,s.A)(e,o);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:t,"aria-labelledby":n},i),r?a.createElement("title",{id:n},r):null,a.createElement("path",{fillRule:"evenodd",d:"M11.03 3.97a.75.75 0 010 1.06l-6.22 6.22H21a.75.75 0 010 1.5H4.81l6.22 6.22a.75.75 0 11-1.06 1.06l-7.5-7.5a.75.75 0 010-1.06l7.5-7.5a.75.75 0 011.06 0z",clipRule:"evenodd"}))}))},2957:(e,t,r)=>{r.d(t,{A:()=>B});var s=r(2555),a=r(5043),o=r(6510),n=r(3986);const i=["title","titleId"];const l=a.forwardRef((function(e,t){let{title:r,titleId:s}=e,o=(0,n.A)(e,i);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:t,"aria-labelledby":s},o),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}));var c=r(4228),d=r(2455);const m=["title","titleId"];const u=a.forwardRef((function(e,t){let{title:r,titleId:s}=e,o=(0,n.A)(e,m);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:t,"aria-labelledby":s},o),r?a.createElement("title",{id:s},r):null,a.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"}))}));var x=r(2136),g=r(8327),b=r(3059),h=r(4858),p=r(4111),f=r(579);const j=e=>{var t;let{readOnly:r=!1,draftData:o=null}=e;const{t:n}=(0,x.ok)(),{formData:i,updateFormData:l,saveJobTicketAsDraft:c}=(0,b.yS)(),[d,m]=(0,a.useState)(""),{register:u,handleSubmit:g,control:j,setValue:w,watch:y,formState:{errors:v}}=(0,h.mN)({defaultValues:o||i}),k=y("workStartTime"),N=y("workEndTime"),T=y("travelStartTime"),S=y("travelEndTime");(0,a.useEffect)((()=>{if(k&&N){const e=(0,p._P)(k,N);null!==e&&w("workTotalHours",e)}}),[k,N,w]),(0,a.useEffect)((()=>{if(T&&S){const e=(0,p._P)(T,S);null!==e&&w("driveTotalHours",e)}}),[T,S,w]),(0,a.useEffect)((()=>{const e=y(((e,t)=>{let{name:r,type:s}=t;"change"===s&&r&&l(r,e[r])}));return()=>e.unsubscribe()}),[y,l]);const{submitJobTicket:E,isSubmitting:C,submitError:A,submitSuccess:D}=(0,b.yS)(),[R,F]=(0,a.useState)(!1),[O,V]=(0,a.useState)(!1);(0,a.useEffect)((()=>{D&&(F(!0),setTimeout((()=>F(!1)),5e3))}),[D]),(0,a.useEffect)((()=>{A&&(V(!0),setTimeout((()=>V(!1)),5e3))}),[A]);return(0,f.jsxs)("form",{onSubmit:g((async e=>{try{const t=c(e);await E(t)}catch(t){console.error("Error submitting job ticket:",t)}})),className:"space-y-8 max-w-3xl mx-auto",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"jobDate",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.date")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"date",id:"jobDate",name:"jobDate",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("jobDate",{required:!0})))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"companyName",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.companyName")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"companyName",name:"companyName",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("companyName",{required:!0})))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.customerName")||"Customer Name"}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"customerName",name:"customerName",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("customerName")))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.location")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"location",name:"location",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("location")))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"workType",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.workType")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"workType",name:"workType",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("workType")))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"equipment",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.equipment")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"equipment",name:"equipment",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("equipment")))})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"workStartTime",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.workStartTime")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"time",id:"workStartTime",name:"workStartTime",className:"bg-gray-800 block w-full rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("workStartTime")))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"workEndTime",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.workEndTime")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"time",id:"workEndTime",name:"workEndTime",className:"bg-gray-800 block w-full rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("workEndTime")))})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"workTotalHours",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.workTotalTime")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"workTotalHours",name:"workTotalHours",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:!0},u("workTotalHours")))})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"driveStartTime",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.travelStartTime")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"time",id:"driveStartTime",name:"driveStartTime",className:"bg-gray-800 block w-full rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("driveStartTime")))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"driveEndTime",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.travelEndTime")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"time",id:"driveEndTime",name:"driveEndTime",className:"bg-gray-800 block w-full rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("driveEndTime")))})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"driveTotalHours",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.travelTotalTime")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"driveTotalHours",name:"driveTotalHours",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:!0},u("driveTotalHours")))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:n("jobTicket.travelType")}),(0,f.jsx)("div",{className:"flex space-x-4",children:(0,f.jsx)(h.xI,{name:"travelType",control:j,render:e=>{let{field:t}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("label",{className:"\n                  flex items-center justify-center px-3 py-2 rounded-md cursor-pointer\n                  ".concat("oneWay"===t.value?"bg-orange-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600","\n                  ").concat(r?"pointer-events-none":"","\n                "),children:[(0,f.jsx)("input",{type:"radio",value:"oneWay",className:"sr-only",disabled:r,onChange:()=>t.onChange("oneWay"),checked:"oneWay"===t.value}),(0,f.jsx)("span",{children:n("jobTicket.oneWay")})]}),(0,f.jsxs)("label",{className:"\n                  flex items-center justify-center px-3 py-2 rounded-md cursor-pointer\n                  ".concat("roundTrip"===t.value?"bg-orange-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600","\n                  ").concat(r?"pointer-events-none":"","\n                "),children:[(0,f.jsx)("input",{type:"radio",value:"roundTrip",className:"sr-only",disabled:r,onChange:()=>t.onChange("roundTrip"),checked:"roundTrip"===t.value}),(0,f.jsx)("span",{children:n("jobTicket.roundTrip")})]})]})}})})]}),(0,f.jsxs)("div",{className:"max-w-3xl",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:n("jobTicket.parts.title")}),!r&&(0,f.jsxs)("div",{className:"flex space-x-2 mb-2",children:[(0,f.jsxs)("select",{value:d,onChange:e=>m(e.target.value),className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",children:[(0,f.jsx)("option",{value:"",children:n("jobTicket.parts.placeholder")}),[{value:n("jobTicket.parts.lubricant"),label:n("jobTicket.parts.lubricant")},{value:n("jobTicket.parts.pumpSeal"),label:n("jobTicket.parts.pumpSeal")},{value:n("jobTicket.parts.thrustChamber"),label:n("jobTicket.parts.thrustChamber")},{value:n("jobTicket.parts.vfdBreakerSwitch"),label:n("jobTicket.parts.vfdBreakerSwitch")},{value:n("jobTicket.parts.serviceKit"),label:n("jobTicket.parts.serviceKit")},{value:n("jobTicket.parts.other"),label:n("jobTicket.parts.other")}].map((e=>(0,f.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,f.jsx)("button",{type:"button",onClick:()=>{if(!d)return;const e=y("partsUsed")||[];w("partsUsed",[...e,d]),m("")},disabled:!d,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:n("jobTicket.addPart")})]}),(0,f.jsx)("div",{className:"mt-2 space-y-2",children:null===(t=y("partsUsed"))||void 0===t?void 0:t.map(((e,t)=>(0,f.jsxs)("div",{className:"flex items-center justify-between bg-gray-700 px-3 py-2 rounded-md",children:[(0,f.jsx)("span",{children:e}),!r&&(0,f.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...y("partsUsed")||[]];t.splice(e,1),w("partsUsed",t)})(t),className:"text-gray-400 hover:text-white",children:(0,f.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,f.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},t)))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"workDescription",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.workDescription")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("textarea",(0,s.A)({id:"workDescription",name:"workDescription",rows:4,className:"bg-gray-800 block w-full max-w-2xl rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("workDescription")))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"submittedBy",className:"block text-sm font-medium text-gray-300",children:n("jobTicket.submittedBy")}),(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)("input",(0,s.A)({type:"text",id:"submittedBy",name:"submittedBy",className:"bg-gray-800 block w-full max-w-md rounded-md border-gray-700 text-white shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm",readOnly:r},u("submittedBy")))})]}),R&&(0,f.jsxs)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[(0,f.jsxs)("strong",{className:"font-bold",children:[n("common.success"),"!"]}),(0,f.jsxs)("span",{className:"block sm:inline",children:[" ",n("jobTicket.submitted")]})]}),O&&(0,f.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[(0,f.jsxs)("strong",{className:"font-bold",children:[n("common.error"),"!"]}),(0,f.jsxs)("span",{className:"block sm:inline",children:[" ",n("jobTicket.submitError")]})]}),!r&&(0,f.jsx)("div",{className:"pt-5",children:(0,f.jsx)("div",{className:"flex justify-center sm:justify-end",children:(0,f.jsxs)("button",{type:"submit",disabled:C,className:"inline-flex justify-center py-2 px-6 border border-transparent shadow-sm text-sm font-medium rounded-md text-white ".concat(C?"bg-gray-500":"bg-orange-600 hover:bg-orange-700"," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-colors duration-200"),children:[n(C?"common.submitting":"jobTicket.submit"),C&&(0,f.jsxs)("svg",{className:"animate-spin ml-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,f.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,f.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]})})})]})},w=(0,a.memo)(j),y=e=>{const t=[/(?:company|company name|for company|at company|with company)[:\s]+([^.,]+)/i,/(?:job|work)(?:\s+is)?(?:\s+for)?(?:\s+company)?[:\s]+([^.,]+)/i,/(?:at|for)[:\s]+([^.,]+?)(?:\s+(?:in|at|on|job|work))/i];for(const r of t){const t=e.match(r);if(t&&t[1])return t[1].trim()}return""},v=e=>{const t=[/(?:customer|customer name|client|client name)[:\s]+([^.,]+)/i,/(?:for|with) customer[:\s]+([^.,]+)/i];for(const r of t){const t=e.match(r);if(t&&t[1])return t[1].trim()}return""},k=e=>{const t=[/(?:location|site|address|place|facility|well|lease)[:\s]+([^.,]+)/i,/(?:at|in) (?:location|site|address|place|facility|well|lease)[:\s]+([^.,]+)/i,/(?:at|in)[:\s]+([^.,]+?)(?:\s+(?:on|for|to|performed|did|completed))/i];for(const r of t){const t=e.match(r);if(t&&t[1])return t[1].trim()}return""},N=e=>{const t=[/(?:work type|type of work|job type)[:\s]+([^.,]+)/i,/(?:performed|did|completed)[:\s]+([^.,]+?)(?:\s+(?:at|on|for|work|job))/i];for(const r of t){const t=e.match(r);if(t&&t[1])return t[1].trim()}return""},T=e=>{const t=[/(?:equipment|machine|pump|unit|system)[:\s]+([^.,]+)/i,/(?:worked on|serviced|repaired|maintained)[:\s]+([^.,]+?)(?:\s+(?:at|on|for|which|that))/i];for(const r of t){const t=e.match(r);if(t&&t[1])return t[1].trim()}return""},S=e=>{const t=[/(?:work description|description of work|work performed|job description)[:\s]+([^.]+)/i,/(?:performed|did|completed|work included)[:\s]+([^.]+)/i];for(const r of t){const t=e.match(r);if(t&&t[1])return t[1].trim()}return e},E=e=>{const t=[],r=["lubricant","pump seal","thrust chamber","vfd breaker","vfd switch","service kit","safety maintenance kit","maintenance kit"],s=e.match(/(?:parts used|used parts|parts|replaced|installed)[:\s]+([^.]+)/i);if(s&&s[1]){const e=s[1].toLowerCase();r.forEach((r=>{e.includes(r)&&t.push(r)}))}else r.forEach((r=>{e.includes(r)&&t.push(r)}));return t},C=e=>{const t=[/(?:submitted by|completed by|technician|tech|my name is|this is)[:\s]+([^.,]+)/i,/(?:submitted|completed)(?:\s+by)?[:\s]+([^.,]+)/i];for(const r of t){const t=e.match(r);if(t&&t[1])return t[1].trim()}return""},A=e=>{const t={},r=/(\d{1,2})(?::(\d{2}))?(?:\s*(am|pm))?/i,s=e.match(/(?:work|job)(?:\s+start(?:ed)?|\s+begin|began)(?:\s+at)?[:\s]+([^.,]+)/i);if(s&&s[1]){const e=s[1].match(r);e&&(t.workStartTime=D(e))}const a=e.match(/(?:work|job)(?:\s+end(?:ed)?|finished|complete(?:d)?)(?:\s+at)?[:\s]+([^.,]+)/i);if(a&&a[1]){const e=a[1].match(r);e&&(t.workEndTime=D(e))}const o=e.match(/(?:drive|travel|trip)(?:\s+start(?:ed)?|\s+begin|began)(?:\s+at)?[:\s]+([^.,]+)/i);if(o&&o[1]){const e=o[1].match(r);e&&(t.driveStartTime=D(e))}const n=e.match(/(?:drive|travel|trip)(?:\s+end(?:ed)?|finished|complete(?:d)?)(?:\s+at)?[:\s]+([^.,]+)/i);if(n&&n[1]){const e=n[1].match(r);e&&(t.driveEndTime=D(e))}return t},D=e=>{let t=parseInt(e[1],10);const r=e[2]?e[2]:"00",s=e[3]?e[3].toLowerCase():null;return"pm"===s&&t<12?t+=12:"am"===s&&12===t&&(t=0),"".concat(t.toString().padStart(2,"0"),":").concat(r.padStart(2,"0"))},R=e=>e.includes("one way")||e.includes("oneway")||e.includes("one-way")?"oneWay":e.includes("round trip")||e.includes("roundtrip")||e.includes("round-trip")?"roundTrip":"",F=e=>{const t=e.match(/(\d{1,2})[-./](\d{1,2})[-./](\d{2,4})/);if(t){const e=parseInt(t[1],10),r=parseInt(t[2],10);let s=parseInt(t[3],10);return s<100&&(s+=2e3),"".concat(s,"-").concat(e.toString().padStart(2,"0"),"-").concat(r.toString().padStart(2,"0"))}const r=e.match(/(?:date|job date|on)[:\s]+([^.,]+)/i);if(r&&r[1]){const e=r[1].toLowerCase(),t=new Date;if(e.includes("today"))return O(t);if(e.includes("yesterday")){const e=new Date(t);return e.setDate(e.getDate()-1),O(e)}if(e.includes("tomorrow")){const e=new Date(t);return e.setDate(e.getDate()+1),O(e)}}return O(new Date)},O=e=>{const t=e.getFullYear(),r=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(s)},V=()=>{const{translations:e,t:t}=(0,x.ok)(),{voiceStatus:r,transcribedText:n,transcriptionError:i,startVoiceRecording:m,stopVoiceRecording:h,cancelVoiceRecording:p}=(0,g.c0)(),{setTicketMode:j,setViewMode:D,saveJobTicketAsDraft:O,setSelectedDraftTicket:V,updateFormData:B}=(0,b.yS)(),[I,L]=(0,a.useState)({});(0,a.useEffect)((()=>{if(n&&"captured"===r){const e=(e=>{if(!e)return{};const t=e.toLowerCase().trim(),r={};r.companyName=y(t),r.customerName=v(t),r.location=k(t),r.workType=N(t),r.equipment=T(t),r.workDescription=S(t),r.partsUsed=E(t),r.submittedBy=C(t);const s=A(t);return s.workStartTime&&(r.workStartTime=s.workStartTime),s.workEndTime&&(r.workEndTime=s.workEndTime),s.driveStartTime&&(r.driveStartTime=s.driveStartTime),s.driveEndTime&&(r.driveEndTime=s.driveEndTime),r.travelType=R(t),r.jobDate=F(t),r})(n);console.log("Parsed job ticket data:",e),L(e),Object.entries(e).forEach((e=>{let[t,r]=e;r&&B(t,r)}))}}),[n,r,B]);const H=()=>{j(null),D("landing"),p()};return(0,f.jsxs)("div",{children:[(0,f.jsxs)("button",{onClick:H,className:"flex items-center text-gray-400 hover:text-white mb-6",children:[(0,f.jsx)(d.A,{className:"h-4 w-4 mr-1"}),e.back]}),"listening"===r&&(0,f.jsxs)("div",{className:"flex flex-col items-center",children:[(0,f.jsx)("p",{className:"text-2xl md:text-3xl font-bold text-orange-500 mb-8",children:e.speakJobTicketInfo}),(0,f.jsxs)("div",{className:"relative mb-8",children:[(0,f.jsx)("div",{className:"pulse-dot",children:(0,f.jsx)(o.A,{className:"h-20 w-20 mx-auto mb-4 text-orange-500"})}),(0,f.jsxs)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 -z-10",children:[(0,f.jsx)("div",{className:"h-24 w-24 rounded-full bg-orange-500 opacity-20 pulse-ring"}),(0,f.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 h-32 w-32 rounded-full bg-orange-500 opacity-10 pulse-ring animation-delay-300"}),(0,f.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 h-40 w-40 rounded-full bg-orange-500 opacity-5 pulse-ring animation-delay-600"})]})]}),(0,f.jsxs)("div",{className:"waveform mb-8",children:[(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"}),(0,f.jsx)("div",{className:"waveform-bar"})]}),(0,f.jsx)("p",{className:"text-xl font-medium mb-6",children:e.listening}),(0,f.jsxs)("div",{className:"flex flex-col space-y-4 items-center",children:[(0,f.jsxs)("div",{className:"flex flex-wrap justify-center gap-4",children:[(0,f.jsxs)("button",{onClick:h,className:"bg-orange-700 hover:bg-orange-800 text-white px-6 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[(0,f.jsx)(l,{className:"h-5 w-5"}),(0,f.jsx)("span",{children:e.stopRecording})]}),(0,f.jsx)("button",{onClick:p,className:"bg-gray-700 hover:bg-gray-800 text-white px-6 py-2 rounded-lg transition-colors",children:e.cancelRecording})]}),(0,f.jsxs)("div",{className:"flex flex-wrap justify-center gap-4 mt-4",children:[(0,f.jsxs)("button",{onClick:m,className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[(0,f.jsx)(o.A,{className:"h-5 w-5"}),(0,f.jsx)("span",{children:e.restartRecording})]}),(0,f.jsxs)("button",{onClick:h,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[(0,f.jsx)(c.A,{className:"h-5 w-5"}),(0,f.jsx)("span",{children:e.allDoneCreateJobTicket})]})]})]})]}),"processing"===r&&(0,f.jsxs)("div",{className:"flex flex-col items-center",children:[(0,f.jsx)("div",{className:"mb-4",children:(0,f.jsxs)("svg",{className:"animate-spin h-10 w-10 text-orange-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,f.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,f.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,f.jsx)("p",{className:"text-xl font-medium",children:e.processingAudio})]}),"error"===r&&(0,f.jsxs)("div",{className:"flex flex-col items-center",children:[(0,f.jsx)("div",{className:"text-red-500 mb-4",children:(0,f.jsx)(u,{className:"h-16 w-16 mx-auto"})}),(0,f.jsx)("p",{className:"text-xl font-medium text-red-500 mb-4",children:i}),(0,f.jsx)("button",{onClick:()=>j(null),className:"bg-orange-700 hover:bg-orange-800 text-white px-6 py-2 rounded-lg transition-colors",children:e.goBack})]}),"captured"===r&&(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,f.jsx)("h2",{className:"text-2xl font-bold",children:t("jobTicket.voiceCaptured")}),(0,f.jsxs)("button",{onClick:H,className:"bg-gray-700 hover:bg-gray-800 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[(0,f.jsx)(d.A,{className:"h-5 w-5"}),(0,f.jsx)("span",{children:t("jobTicket.goBack")})]})]}),(0,f.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 mb-8 border-2 border-orange-500",children:[(0,f.jsx)("h3",{className:"text-xl font-bold mb-3 text-orange-500",children:t("jobTicket.rawTranscription")}),(0,f.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-lg max-h-60 overflow-y-auto",children:(0,f.jsx)("p",{className:"text-gray-900 dark:text-gray-100 text-lg",children:n||t("jobTicket.noTranscriptionAvailable")})})]}),(0,f.jsxs)("div",{className:"flex flex-wrap gap-4 justify-center mb-8",children:[(0,f.jsxs)("button",{onClick:m,className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg transition-colors flex items-center space-x-2 text-lg",children:[(0,f.jsx)(o.A,{className:"h-6 w-6"}),(0,f.jsx)("span",{children:t("jobTicket.restartRecording")})]}),(0,f.jsxs)("button",{onClick:()=>{const e=O((0,s.A)((0,s.A)({},I),{},{workDescription:n}));V(e),D("draft")},className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition-colors flex items-center space-x-2 text-lg",children:[(0,f.jsx)(c.A,{className:"h-6 w-6"}),(0,f.jsx)("span",{children:t("jobTicket.submit")})]})]}),(0,f.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-700",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>{const e=document.getElementById("extractedDataDetails");e&&(e.open=!e.open)},children:[(0,f.jsx)("h3",{className:"text-lg font-medium",children:t("jobTicket.extractedData")}),(0,f.jsx)("span",{className:"text-sm text-gray-400",children:"(Click to expand/collapse)"})]}),(0,f.jsxs)("details",{id:"extractedDataDetails",className:"mt-2",children:[(0,f.jsx)("summary",{className:"sr-only",children:"Extracted Data Details"}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pl-4 border-l-2 border-gray-700",children:[Object.entries(I).map((e=>{let[t,r]=e;if(!r||Array.isArray(r)&&0===r.length)return null;const s=t.replace(/([A-Z])/g," $1").replace(/^./,(e=>e.toUpperCase())),a=Array.isArray(r)?r.join(", "):r;return(0,f.jsxs)("div",{className:"flex",children:[(0,f.jsxs)("span",{className:"font-medium text-gray-400 mr-2",children:[s,":"]}),(0,f.jsx)("span",{className:"text-white",children:a})]},t)})),(0,f.jsxs)("div",{className:"col-span-2 mt-4 flex items-center",children:[(0,f.jsxs)("span",{className:"text-sm text-gray-400 mr-2",children:[t("jobTicket.recognitionQuality"),":"]}),(0,f.jsx)("div",{className:"flex space-x-1",children:Object.keys(I).filter((e=>!!I[e])).length>=5?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500"}),(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500"}),(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500"}),(0,f.jsx)("span",{className:"ml-2 text-green-500 text-xs",children:"Good"})]}):Object.keys(I).filter((e=>!!I[e])).length>=3?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-yellow-500"}),(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-yellow-500"}),(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-gray-600"}),(0,f.jsx)("span",{className:"ml-2 text-yellow-500 text-xs",children:"Fair"})]}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-red-500"}),(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-gray-600"}),(0,f.jsx)("div",{className:"h-2 w-2 rounded-full bg-gray-600"}),(0,f.jsx)("span",{className:"ml-2 text-red-500 text-xs",children:"Poor"})]})})]})]})]})]}),(0,f.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-6 border border-gray-700",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>{const e=document.getElementById("jobTicketFormDetails");e&&(e.open=!e.open)},children:[(0,f.jsx)("h3",{className:"text-lg font-medium",children:t("jobTicket.editForm")}),(0,f.jsx)("span",{className:"text-sm text-gray-400",children:"(Click to expand/collapse)"})]}),(0,f.jsxs)("details",{id:"jobTicketFormDetails",className:"mt-2",children:[(0,f.jsx)("summary",{className:"sr-only",children:"Job Ticket Form"}),(0,f.jsx)("div",{className:"mt-4",children:(0,f.jsx)(w,{})})]})]})]})]})},B=(0,a.memo)(V)},4228:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(3986),a=r(5043);const o=["title","titleId"];const n=a.forwardRef((function(e,t){let{title:r,titleId:n}=e,i=(0,s.A)(e,o);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:t,"aria-labelledby":n},i),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"}))}))},6510:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(3986),a=r(5043);const o=["title","titleId"];const n=a.forwardRef((function(e,t){let{title:r,titleId:n}=e,i=(0,s.A)(e,o);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:t,"aria-labelledby":n},i),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z"}))}))},8327:(e,t,r)=>{r.d(t,{QP:()=>i,c0:()=>l});var s=r(5043),a=r(2136),o=r(579);const n=(0,s.createContext)(),i=e=>{let{children:t}=e;const{t:r}=(0,a.ok)(),[i,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(""),[m,u]=(0,s.useState)(""),[x,g]=(0,s.useState)(!1),b=(0,s.useRef)(null),h=(0,s.useRef)(null);(0,s.useEffect)((()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window))return void console.error("Speech recognition not supported");const e=window.SpeechRecognition||window.webkitSpeechRecognition;return b.current=new e,b.current.continuous=!0,b.current.interimResults=!0,b.current.lang="en-US",()=>{if(b.current)try{b.current.stop()}catch(e){console.error("Error stopping recognition:",e)}h.current&&clearTimeout(h.current)}}),[]);const p=(0,s.useCallback)((()=>{h.current&&clearTimeout(h.current),h.current=setTimeout((()=>{x&&(j(),u(r("listeningTimeout")),l("error"))}),15e3)}),[x,r]),f=(0,s.useCallback)((()=>{if(!b.current)return u(r("browserNotSupported")),void l("error");d(""),u(""),l("listening"),g(!0);try{b.current.onstart=()=>{console.log("Voice recognition started"),p()},b.current.onresult=e=>{p();const t=Array.from(e.results).map((e=>e[0].transcript)).join(" ");d(t)},b.current.onerror=e=>{console.error("Speech recognition error",e.error),"no-speech"===e.error?u(r("noSpeechDetected")):"not-allowed"===e.error?u(r("microphoneError")):u(r("transcriptionError")),l("error"),g(!1),h.current&&clearTimeout(h.current)},b.current.onend=()=>{if(console.log("Voice recognition ended"),x&&"listening"===i)try{b.current.start()}catch(e){console.error("Error restarting recognition:",e)}else g(!1),"listening"===i&&l("captured")},b.current.start()}catch(e){console.error("Error starting voice recognition:",e),u(r("transcriptionError")),l("error"),g(!1)}}),[x,p,r,i]),j=(0,s.useCallback)((()=>{if(b.current&&x)try{b.current.stop(),console.log("Voice recognition stopped")}catch(e){console.error("Error stopping recognition:",e)}h.current&&(clearTimeout(h.current),h.current=null),g(!1),l("processing"),setTimeout((()=>{c?l("captured"):(u(r("noSpeechDetected")),l("error"))}),1e3)}),[x,r,c]),w=(0,s.useCallback)((()=>{if(b.current&&x)try{b.current.stop(),console.log("Voice recognition cancelled")}catch(e){console.error("Error stopping recognition:",e)}h.current&&(clearTimeout(h.current),h.current=null),g(!1),l(null),d(""),u("")}),[x]),y={voiceStatus:i,setVoiceStatus:l,transcribedText:c,setTranscribedText:d,transcriptionError:m,setTranscriptionError:u,isListening:x,startVoiceRecording:f,stopVoiceRecording:j,cancelVoiceRecording:w};return(0,o.jsx)(n.Provider,{value:y,children:t})},l=()=>{const e=(0,s.useContext)(n);if(!e)throw new Error("useVoice must be used within a VoiceProvider");return e}}}]);
//# sourceMappingURL=957.e78e099d.chunk.js.map